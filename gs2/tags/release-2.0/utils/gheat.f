      real function gheat(w_over_wcrit)

      real x(101),g(101),w_over_wcrit,y,z
      data x /0.0000000000E+00,  0.8632734531E-01,  0.1387225549,    
     .        0.1841317365    ,  0.2255489022    ,  0.2644710579,    
     .        0.3018962076    ,  0.3383233533    ,  0.3742514970,    
     .        0.4096806387    ,  0.4446107784    ,  0.4795409182,    
     .        0.5144710579    ,  0.5494011976    ,  0.5843313373,    
     .        0.6192614770    ,  0.6546906188    ,  0.6906187625,    
     .        0.7265469062    ,  0.7629740519    ,  0.7999001996,    
     .        0.8373253493    ,  0.8752495010    ,  0.9141716567,    
     .        0.9535928144    ,  0.9940119760    ,   1.034930140,    
     .        1.076846307    ,   1.119760479    ,   1.163672655,    
     .        1.208582834    ,   1.254491018    ,   1.301397206,    
     .        1.349301397    ,   1.398702595    ,   1.449600798,    
     .        1.501497006    ,   1.554890220    ,   1.609780439,    
     .        1.666666667    ,   1.725049900    ,   1.785429142,    
     .        1.847804391    ,   1.912175649    ,   1.978542914,    
     .        2.047405190    ,   2.118762475    ,   2.192614770,    
     .        2.269461078    ,   2.349301397    ,   2.432135729,    
     .        2.518463074    ,   2.608283433    ,   2.702095808,    
     .        2.799900200    ,   2.901696607    ,   3.008483034,    
     .        3.120259481    ,   3.237524950    ,   3.360279441,    
     .        3.489520958    ,   3.625249501    ,   3.768463074,    
     .        3.919660679    ,   4.079341317    ,   4.248502994,    
     .        4.427644711    ,   4.618263473    ,   4.820858283,    
     .        5.036926148    ,   5.267964072    ,   5.515469062,    
     .        5.781437126    ,   6.067864271    ,   6.377245509,    
     .        6.712075848    ,   7.076347305    ,   7.473552894,    
     .        7.908183633    ,   8.385728543    ,   8.913173653,    
     .        9.499001996    ,   10.15269461    ,   10.88672655,    
     .        11.71706587    ,   12.66317365    ,   13.75149701,    
     .        15.01546906    ,   16.50149701    ,   18.27245509,    
     .        20.41766467    ,   23.06836327    ,   26.42415170,    
     .        30.80588822    ,   36.76097804    ,   45.30888224,    
     .        58.58383234    ,   81.92614770    ,   133.4665669,    
     .        338.5184631    ,   100000.0000/
      data g / 1.000000000    ,  0.9899698644    ,  0.9799240091,    
     .        0.9698132634    ,  0.9597528937    ,  0.9497421442,    
     .        0.9397256323    ,  0.9296958377    ,  0.9196017550,    
     .        0.9095079279    ,  0.8994662798    ,  0.8893741092,    
     .        0.8792645675    ,  0.8691660723    ,  0.8591029279,    
     .        0.8490958548    ,  0.8390211496    ,  0.8288978189,    
     .        0.8188818524    ,  0.8088478601    ,  0.7988105891,    
     .        0.7887836827    ,  0.7787797215    ,  0.7686819122,    
     .        0.7586337729    ,  0.7485214797    ,  0.7384824424,    
     .        0.7284060663    ,  0.7183071791    ,  0.7081999568,    
     .        0.6980978835    ,  0.6880137212    ,  0.6779594888,    
     .        0.6679464500    ,  0.6578847977    ,  0.6477922797,    
     .        0.6377807734    ,  0.6277661028    ,  0.6177635158,    
     .        0.6077004048    ,  0.5976824199    ,  0.5876402805,    
     .        0.5775932176    ,  0.5675593218    ,  0.5575555087,    
     .        0.5475260678    ,  0.5374929742    ,  0.5274767630,    
     .        0.5174324773    ,  0.5073848782    ,  0.4973569747,    
     .        0.4873130870    ,  0.4772795036    ,  0.4672280828,    
     .        0.4571875643    ,  0.4471842979    ,  0.4371505539,    
     .        0.4271203396    ,  0.4170829629    ,  0.4070724003,    
     .        0.3970437927    ,  0.3870358737    ,  0.3770154565,    
     .        0.3669920682    ,  0.3569777418    ,  0.3469578012,    
     .        0.3369527791    ,  0.3269330469    ,  0.3169294442,    
     .        0.3069272152    ,  0.2969219427    ,  0.2869180543,    
     .        0.2769092205    ,  0.2669002328    ,  0.2568894860,    
     .        0.2468873798    ,  0.2368743996    ,  0.2268634908,    
     .        0.2168578685    ,  0.2068577142    ,  0.1968563943,    
     .        0.1868487628    ,  0.1768444740    ,  0.1668422067,    
     .        0.1568377051    ,  0.1468366620    ,  0.1368326793,    
     .        0.1268316164    ,  0.1168288452    ,  0.1068266720,    
     .        0.9682566232E-01,  0.8682471780E-01,  0.7682454505E-01,
     .        0.6682386704E-01,  0.5682357084E-01,  0.4682320456E-01,
     .        0.3682304466E-01,  0.2682299598E-01,  0.1682297444E-01,
     .        0.6822964948E-02,  0.0000000000E+00/
      
c
c Use the table I created tabulating the integral 
c 
c gheat = 1/x * integral from 0 to x  [ dt/(1+t**1.5) ]
c
c with this call
c
c      call inter_cspl(101,x,g,1,w_over_wcrit,f)
c      gheat=min(1.,max(f,0.))
c
c or use Goldston's expression
c
c (which agrees very well with the numerical integral) 
c
      z=w_over_wcrit
      y=sqrt(z)
      gheat=alog((1.+y**3)/(1.+y)**3)/(3.*z)
     .        +2.*atan2(2.*y-1.,sqrt(3.))/(sqrt(3.)*z)
     .        -2.*atan2(-1.,sqrt(3.))/(sqrt(3.)*z)

c
c Reproduce old results with Greg's formula
c
c      gheat=log(1+z**1.5)/z**1.5
c
      return
      end
